<!DOCTYPE html>
<html>
<head lang="zh-cn">
    <meta charset="UTF-8">
    <title>声彡 - The Silent World</title>
    <meta name="viewport" content="initial-scale=1.0"/>
    <meta name="description" content="一个白噪音网站 DIVINITI制"/>
    <meta name="keywords" content="白噪音 white noise Vango DIVINITI"/>
    <link rel="stylesheet" href="css/main.css"/>
    <link rel="stylesheet" href="css/volume.slider.css"/>
    <link rel="icon" href="icon.png"/>
</head>
<body>
<div class="bg-gradient"></div>

<section class="container">
    <img class="logo" src="img/logo-wih-slogon.png" alt="logo"/>

    <select name="preset" id="preset">
        <option value="0">预设效果</option>
        <option value="1">效果一</option>
        <option value="2">效果二</option>
    </select>

    <ul class="select-holder clearfix">
        <li class="audio-wrapper" id="rain">
            <div class="audio-content">
                <img class="audio-name" src="img/rain.png" alt=""/>

                <div class="volume-ctrl" id="rain_vol_ctrl"></div>
            </div>
        </li>
        <li class="audio-wrapper" id="wind">
            <div class="audio-content">
                <img class="audio-name" src="img/wind.png" alt=""/>

                <div class="volume-ctrl" id="wind_vol_ctrl"></div>
            </div>
        </li>
        <li class="audio-wrapper" id="tide">
            <div class="audio-content">
                <img class="audio-name" src="img/tide.png" alt=""/>

                <div class="volume-ctrl" id="tide_vol_ctrl"></div>
            </div>
        </li>
        <li class="audio-wrapper" id="night">
            <div class="audio-content">
                <img class="audio-name" src="img/night.png" alt=""/>

                <div class="volume-ctrl" id="night_vol_ctrl"></div>
            </div>
        </li>
        <li class="audio-wrapper" id="morning">
            <div class="audio-content">
                <img class="audio-name" src="img/morning.png" alt=""/>

                <div class="volume-ctrl" id="morning_vol_ctrl"></div>
            </div>
        </li>
        <li class="audio-wrapper" id="bell">
            <div class="audio-content">
                <img class="audio-name" src="img/bell.png" alt=""/>

                <div class="volume-ctrl" id="bell_vol_ctrl"></div>
            </div>
        </li>
    </ul>
</section>
<footer> -- Made with love. By <a href="http://weibo.com/2025660943">Vango in DIVINITI</a> --</footer>
<script src="js/jquery.min.js"></script>
<script src="js/volume.ctrl.js"></script>
<script>
    var rainAudio = document.createElement("audio");
    rainAudio.setAttribute("src", "audio/rain.mp3");
    rainAudio.volume = .5;
    rainAudio.loop = true;

    var windAudio = document.createElement("audio");
    windAudio.setAttribute("src", "audio/wind.mp3");
    windAudio.volume = .5;
    windAudio.loop = true;

    var tideAudio = document.createElement("audio");
    tideAudio.setAttribute("src", "audio/tide.mp3");
    tideAudio.volume = .5;
    tideAudio.loop = true;

    var nightAudio = document.createElement("audio");
    nightAudio.setAttribute("src", "audio/night.mp3");
    nightAudio.volume = .5;
    nightAudio.loop = true;

    var morningAudio = document.createElement("audio");
    morningAudio.setAttribute("src", "audio/morning.mp3");
    morningAudio.volume = .5;
    morningAudio.loop = true;

    var bellAudio = document.createElement("audio");
    bellAudio.setAttribute("src", "audio/bell.mp3");
    bellAudio.volume = .5;
    bellAudio.loop = true;

    $(".audio-wrapper").click(function (e) {
        e.preventDefault();
        var targetClass = e.target.classList;

        if (!targetClass.contains("slider-container") && !targetClass.contains("slider-wrapper") && !targetClass.contains("slider-container") && !targetClass.contains("slider-loaded") && !targetClass.contains("slider-handler") && !targetClass.contains("slider-range")) {

            $(this).toggleClass("active");
            switch (this.id) {
                case "rain":
                    $(this).hasClass("active") ? rainAudio.play() : rainAudio.pause();
                    break;
                case "wind":
                    $(this).hasClass("active") ? windAudio.play() : windAudio.pause();
                    break;
                case "tide":
                    $(this).hasClass("active") ? tideAudio.play() : tideAudio.pause();
                    break;
                case "night":
                    $(this).hasClass("active") ? nightAudio.play() : nightAudio.pause();
                    break;
                case "morning":
                    $(this).hasClass("active") ? morningAudio.play() : morningAudio.pause();
                    break;
                case "bell":
                    $(this).hasClass("active") ? bellAudio.play() : bellAudio.pause();
                    break;
            }
        }
    });

    $("#rain_vol_ctrl").volumeSlider();
    $("#wind_vol_ctrl").volumeSlider();
    $("#tide_vol_ctrl").volumeSlider();
    $("#night_vol_ctrl").volumeSlider();
    $("#morning_vol_ctrl").volumeSlider();
    $("#bell_vol_ctrl").volumeSlider();

    $(".slider-container").click(function (e) {
        var progress = new Number(e.offsetX * 100 / $(this).width()).toFixed(2);
        $($(this)[0].firstChild.nextSibling).css("width", progress + "%");
        $($(this)[0].lastChild).css("left", progress + "%");
        switch ($(this).parent().parent()[0].id) {
            case"rain_vol_ctrl":
                rainAudio.volume = progress / 100;
                break;
            case"wind_vol_ctrl":
                windAudio.volume = progress / 100;
                break;
            case"tide_vol_ctrl":
                tideAudio.volume = progress / 100;
                break;
            case"night_vol_ctrl":
                nightAudio.volume = progress / 100;
                break;
            case"morning_vol_ctrl":
                morningAudio.volume = progress / 100;
                break;
            case"bell_vol_ctrl":
                bellAudio.volume = progress / 100;
                break;

        }
    });

    var CloseAllAudio = function () {
        rainAudio.pause();
        windAudio.pause();
        tideAudio.pause();
        nightAudio.pause();
        morningAudio.pause();
        bellAudio.pause();
    };

    var setAudioVolume = function (id, vol) {
        var loadedStr = id + " .slider-loaded";
        var handlerStr = id + " .slider-handler";
        console.log($(loadedStr), $(handlerStr));

        switch (id.split("#")[1] + "Audio") {
            case "rainAudio":
                rainAudio.play();
                rainAudio.volume = vol;
                break;
            case "windAudio":
                windAudio.play();
                windAudio.volume = vol;
                break;
            case "tideAudio":
                tideAudio.play();
                tideAudio.volume = vol;
                break;
            case "nightAudio":
                nightAudio.play();
                nightAudio.volume = vol;
                break;
            case "morningAudio":
                morningAudio.play();
                morningAudio.volume = vol;
                break;
            case "bellAudio":
                bellAudio.play();
                bellAudio.volume = vol;
                break;
        }
        $(loadedStr).css("width", vol * 100 + "%");
        $(handlerStr).css("left", vol * 100 + "%");
    }
</script>
<script>
    $("#preset").change(function () {
        CloseAllAudio();
        $(".audio-wrapper").removeClass("active");

        switch ($("option:selected").val()) {
            case "1":
                $.ajax({
                    url: "preset/bell-with-wind.json",
                    dataType: "json",
                    success: function (data) {
                        for (var i = 0; i < data.activeModel.length; i++) {
                            var id = data.activeModel[i];
                            var vol = data.activeVolume[i];
                            $(id).addClass("active");
                            setAudioVolume(id, vol);
                        }
                    }, error: function (msg) {
                        console.log(msg);
                    }
                });
                break;
            case "2":
                $.ajax({
                    url: "preset/night-with-wind-and-rain.json",
                    dataType: "json",
                    success: function (data) {
                        for (var i = 0; i < data.activeModel.length; i++) {
                            var id = data.activeModel[i];
                            var vol = data.activeVolume[i];
                            $(id).addClass("active");
                            setAudioVolume(id, vol);
                        }
                    }, error: function (msg) {
                        console.log(msg);
                    }
                });
                break;
        }
    });
</script>
<script type="text/javascript">var cnzz_protocol = (("https:" == document.location.protocol) ? " https://" : " http://");
document.write(unescape("%3Cspan id='cnzz_stat_icon_1256725667'%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "s95.cnzz.com/z_stat.php%3Fid%3D1256725667%26show%3Dpic' type='text/javascript'%3E%3C/script%3E"));</script>
</body>
</html>